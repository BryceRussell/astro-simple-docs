---
import { CollectionEntry, getCollection } from 'astro:content';
import fg from 'fast-glob';
import Markdown from "@/layouts/Markdown.astro";
import TableOfContents from '@/components/TableOfContents.astro';

export async function getStaticPaths() {
    // Automatically create indexes for directories
    const pages = await getCollection('docs')
    //const urls = fg.sync('src/pages/**', { onlyDirectories: true }).map(d => d.replace('src/pages/', ''))
    return pages.map(page => ({
        params: {
            url: `docs/${page.slug}`
        },
        props: {
            url: `/docs/${page.slug}`,
            page
        }
    }))
}

export interface Props {
    url: string,
    page: CollectionEntry<'docs'>
}

const {
    url,
    page
} = Astro.props as Props

const {
    Content,
    headings
} = await page.render()
---

<Markdown frontmatter={page.data} headings={headings}>
    <Content />
</Markdown>