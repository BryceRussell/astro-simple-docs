---
import Grid from "@/layouts/Grid.astro";
import RootFileTree from "@/components/RootFileTree.astro";
import TableOfContents from "@/components/TableOfContents.astro";
import type { MarkdownInstance } from "astro";
import type { Frontmatter } from "@/types";
import { renderMarkdown } from '@astrojs/markdown-remark'

console.log(await renderMarkdown("# TEst", {}).then(r => r.vfile.data))

var pages: MarkdownInstance<Frontmatter>[] = []

try {
    pages = await Astro.glob<Frontmatter>('/src/pages/docs/**/*.md')
} catch {
    console.warn("Could not find any markdown files, create a new entry at /admin")
}
---

<Grid>
    <RootFileTree slot="sidebar-left" pages={pages} />
    <nav style="display:flex;flex-direction:column;gap:.5em;">
        { pages.map(page => <TableOfContents url={page.url} headings={page.getHeadings()} max={2}/>) }
    </nav>
</Grid>


